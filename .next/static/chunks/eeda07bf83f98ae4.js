(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,41944,t=>{"use strict";let e={get url(){return`file://${t.P("node_modules/@github/spark/dist/kv-WMiiBMWU.js")}`}},r="sparkKvUpdated",a=t=>{e.env.DEV&&window.parent.postMessage(t,"*")};class s{async getKeys(){let t,e=await fetch(BASE_KV_SERVICE_URL,{method:"GET"});if(!e.ok)return Promise.reject(Error(`Failed to fetch KV keys: ${e.statusText}`));try{t=await e.json()}catch(t){return Promise.reject(Error("Failed to parse KV keys response"))}return Array.isArray(t)?t:Promise.reject(Error("KV keys response is not an array"))}async getAll(){let t=await this.getKeys(),e={},r=await Promise.all(t.map(t=>this.getKey(t)));return t.forEach((t,a)=>{let s=r[a];void 0!==s&&(e[t]=s)}),e}async getKey(t){let e=await fetch(`${BASE_KV_SERVICE_URL}/${encodeURIComponent(t)}`,{method:"GET",headers:{"Content-Type":"text/plain"}});if(!e.ok){let t=`Failed to fetch KV key: ${e.statusText}`;if(404===e.status)return;return Promise.reject(Error(t))}let r=await e.text();try{return JSON.parse(r)}catch(t){return Promise.reject(Error("Failed to parse KV key response"))}}async getOrSetKey(t,e){let s=await this.getKey(t);if(void 0!==s)return s;let i=await fetch(`${BASE_KV_SERVICE_URL}/${encodeURIComponent(t)}`,{method:"POST",headers:{"Content-Type":"text/plain","X-Spark-Initial":"true"},body:JSON.stringify(e)});return i.ok?(a({type:r,payload:{key:t}}),e):Promise.reject(Error(`Failed to set default value for key: ${i.statusText}`))}async setKey(t,e){let s=await fetch(`${BASE_KV_SERVICE_URL}/${encodeURIComponent(t)}`,{method:"POST",headers:{"Content-Type":"text/plain","X-Spark-Initial":"false"},body:JSON.stringify(e)});if(!s.ok)return Promise.reject(Error(`Failed to set key: ${s.statusText}`));a({type:r,payload:{key:t,value:JSON.stringify(e)}})}async deleteKey(t){await fetch(`${BASE_KV_SERVICE_URL}/${encodeURIComponent(t)}`,{method:"DELETE"}),a({type:"sparkKvDeleted",payload:{key:t}})}}let i={"ai21-jamba-instruct":"ai21-labs/ai21-jamba-instruct","cohere-command-r-plus":"cohere/cohere-command-r-plus","cohere-command-r":"cohere/cohere-command-r","gpt-4o-mini":"openai/gpt-4o-mini","gpt-4o":"openai/gpt-4o","meta-llama-3.1-405b-instruct":"meta/meta-llama-3.1-405b-instruct","meta-llama-3.1-70b-instruct":"meta/meta-llama-3.1-70b-instruct","meta-llama-3.1-8b-instruct":"meta/meta-llama-3.1-8b-instruct","meta-llama-3-70b-instruct":"meta/meta-llama-3-70b-instruct","meta-llama-3-8b-instruct":"meta/meta-llama-3-8b-instruct","mistral-large-2407":"mistral-ai/mistral-large-2407","mistral-large":"mistral-ai/mistral-large","mistral-nemo":"mistral-ai/mistral-nemo","mistral-small":"mistral-ai/mistral-small","phi-3-medium-128K-instruct":"microsoft/phi-3-medium-128K-instruct","phi-3-medium-4K-instruct":"microsoft/phi-3-medium-4K-instruct","phi-3-mini-128K-instruct":"microsoft/phi-3-mini-128K-instruct","phi-3-mini-4K-instruct":"microsoft/phi-3-mini-4K-instruct","phi-3-small-128K-instruct":"microsoft/phi-3-small-128K-instruct","phi-3-small-8K-instruct":"microsoft/phi-3-small-8K-instruct"};async function o(t,e,r){let a=e?i[e]||e:"openai/gpt-4o",s=await fetch("/_spark/llm",{method:"POST",body:JSON.stringify({messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:t}],temperature:1,top_p:1,max_tokens:1e3,model:a,response_format:{type:r?"json_object":"text"}}),headers:{"Content-Type":"application/json"}});if(!s.ok){let t=await s.text();throw Error(`LLM request failed: ${s.status} ${s.statusText} - ${t}`)}return(await s.json()).choices[0].message.content}let n=null;async function l(){try{if(n)return n;let t=await fetch("/_spark/user");return n=await t.json()}catch(t){return console.error("Failed to fetch user data:",t),null}}let m={url:window?.location?.href,load_ms:window?.performance?.now()};window.parent.postMessage({type:"sparkRuntimeLoaded",payload:m},"*"),fetch("/_spark/loaded",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),window.spark={llmPrompt:function(t,...e){return t.reduce((t,r,a)=>t+r+(e[a]||""),"")},llm:o,user:l,kv:{keys:async()=>new s().getKeys(),get:async t=>new s().getKey(t),set:async(t,e)=>new s().setKey(t,e),delete:async t=>new s().deleteKey(t)}},t.s([],41944)}]);